<!DOCTYPE html>
<html>
<head>
    <title>Test WebSocket</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        #messages { border: 1px solid #ccc; padding: 10px; height: 300px; overflow-y: scroll; }
        input { width: 300px; padding: 5px; }
        button { padding: 5px 15px; }
    </style>
</head>
<body>
    <h1>üîå WebSocket Test</h1>
    
    <div>
        <input type="text" id="message" placeholder="Nh·∫≠p tin nh·∫Øn...">
        <button onclick="sendMessage()">G·ª≠i</button>
        <button onclick="connect()">K·∫øt n·ªëi</button>
        <button onclick="disconnect()">Ng·∫Øt</button>
    </div>
    
    <h3>Messages:</h3>
    <div id="messages"></div>

    <script>
        let ws = null;

        function connect() {
            ws = new WebSocket('ws://localhost:8000/ws');
            
            ws.onopen = () => {
                addMessage('‚úÖ ƒê√£ k·∫øt n·ªëi!', 'green');
            };
            
            ws.onmessage = (event) => {
                const data = JSON.parse(event.data);
                addMessage('üì® Nh·∫≠n: ' + JSON.stringify(data, null, 2), 'blue');
            };
            
            ws.onclose = () => {
                addMessage('‚ùå ƒê√£ ng·∫Øt k·∫øt n·ªëi', 'red');
            };
            
            ws.onerror = (error) => {
                addMessage('‚ùå L·ªói: ' + error, 'red');
            };
        }

        function disconnect() {
            if (ws) {
                ws.close();
                ws = null;
            }
        }

        function sendMessage() {
            if (!ws || ws.readyState !== WebSocket.OPEN) {
                alert('Ch∆∞a k·∫øt n·ªëi!');
                return;
            }
            
            const msg = document.getElementById('message').value;
            const data = {
                type: 'text_input',
                data: { text: msg }
            };
            
            ws.send(JSON.stringify(data));
            addMessage('üì§ G·ª≠i: ' + msg, 'green');
            document.getElementById('message').value = '';
        }

        function addMessage(msg, color) {
            const div = document.getElementById('messages');
            const p = document.createElement('p');
            p.style.color = color;
            p.textContent = new Date().toLocaleTimeString() + ' - ' + msg;
            div.appendChild(p);
            div.scrollTop = div.scrollHeight;
        }

        // Auto connect on load
        window.onload = connect;
    </script>
</body>
</html>